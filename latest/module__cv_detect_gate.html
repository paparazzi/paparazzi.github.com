<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Paparazzi UAS: cv_detect_gate module</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="penguin_icon.png"/></td>
  <td id="projectalign">
   <div id="projectname">Paparazzi UAS<span id="projectnumber">&#160;v7.0_unstable</span>
   </div>
   <div id="projectbrief">Paparazzi is a free software Unmanned Aircraft System.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('module__cv_detect_gate.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">cv_detect_gate module</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><b>Detects gates as used in the IROS drone races, i.e., square colored gates</b></p>
<p>It does so with snake gate detection, a computationally efficient method that works onboard of the computationally constrained Parrot Bebop 1/2 drones.</p>
<p>An initial version of this algorithm ran in the drone race 2016. The algorithm was first described in:</p>
<p>First autonomous multi-room exploration with an insect-inspired flapping wing vehicle, May 2018, IEEE International Conference on Robotics and Automation (ICRA 2018), Brisbane, Australia by Kirk Scheper, Matej Karasek, Christophe De Wagter, Bart Remes, and Guido de Croon <a href="https://www.researchgate.net/publication/327228053_First_autonomous_multi-room_exploration_with_an_insect-inspired_flapping_wing_vehicle">https://www.researchgate.net/publication/327228053_First_autonomous_multi-room_exploration_with_an_insect-inspired_flapping_wing_vehicle</a></p>
<p>For the drone race, the algorithm and performance are described in more detail in: Autonomous drone race: A novel vision-based navigation and control strategy, S.Li, M.M.O.I. Ozo, C. De Wagter, G.C.H.E. de Croon. Submitted.</p>
<h1><a class="anchor" id="module_load_example__cv_detect_gate"></a>
Example for airframe file</h1>
<p>Add to your firmware section: This example contains all possible configuration options, not all of them are mandatory! </p><div class="fragment"><div class="line">&lt;<span class="keywordtype">module</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;cv_detect_gate&quot;</span>&gt;</div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;DETECT_GATE_FPS&quot; value=&quot;0&quot; /&gt;\n    &#39;</span></div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;DETECT_GATE_CAMERA&quot; value=&quot;bottom_camera|front_camera&quot; /&gt;\n    &#39;</span></div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;DETECT_GATE_JUST_FILTER&quot; value=&quot;FALSE|TRUE&quot; /&gt;\n    &#39;</span></div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;DETECT_GATE_N_SAMPLES&quot; value=&quot;10000&quot; /&gt;\n    &#39;</span></div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;DETECT_GATE_MIN_PIX_SIZE&quot; value=&quot;30&quot; /&gt;\n    &#39;</span></div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;DETECT_GATE_MIN_GATE_QUALITY&quot; value=&quot;0.15&quot; /&gt;\n    &#39;</span></div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;DETECT_GATE_MIN_N_SIDES&quot; value=&quot;3&quot; /&gt;\n    &#39;</span></div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;DETECT_GATE_GATE_THICKNESS&quot; value=&quot;0.0&quot; /&gt;\n    &#39;</span></div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;DETECT_GATE_Y_MIN&quot; value=&quot;20&quot; /&gt;\n    &#39;</span></div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;DETECT_GATE_Y_MAX&quot; value=&quot;228&quot; /&gt;\n    &#39;</span></div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;DETECT_GATE_U_MIN&quot; value=&quot;42&quot; /&gt;\n    &#39;</span></div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;DETECT_GATE_U_MAX&quot; value=&quot;121&quot; /&gt;\n    &#39;</span></div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;DETECT_GATE_V_MIN&quot; value=&quot;134&quot; /&gt;\n    &#39;</span></div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;DETECT_GATE_V_MAX&quot; value=&quot;230&quot; /&gt;\n    &#39;</span></div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;DETECT_GATE_EXCLUDE_PIXELS_TOP&quot; value=&quot;0&quot; /&gt;\n    &#39;</span></div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;DETECT_GATE_EXCLUDE_PIXELS_BOTTOM&quot; value=&quot;0&quot; /&gt;\n    &#39;</span></div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;DETECT_GATE_SIMPLIFIED_PNP&quot; value=&quot;0&quot; /&gt;\n    &#39;</span></div>
<div class="line">  <span class="keyword">b</span><span class="stringliteral">&#39;&lt;define name=&quot;CAMERA_ROTATED_90DEG_RIGHT&quot; value=&quot;FALSE&quot; /&gt;\n  &#39;</span></div>
<div class="line">&lt;/<span class="keywordtype">module</span>&gt;</div>
</div><!-- fragment --> <h1><a class="anchor" id="configuration__cv_detect_gate"></a>
Module configuration options</h1>
<h2><a class="anchor" id="define"></a>
Define Options</h2>
<ul>
<li><b>name:</b> <code>DETECT_GATE_FPS</code> <b>value:</b> <em>0</em> <br  />
 Description: The (maximum) frequency to run the calculations at. If zero, it will max out at the camera frame rate.</li>
<li><b>name:</b> <code>DETECT_GATE_CAMERA</code> <b>value:</b> <em>bottom_camera|front_camera</em> <br  />
 Description: The V4L2 camera device that is used for the calculations.</li>
<li><b>name:</b> <code>DETECT_GATE_JUST_FILTER</code> <b>value:</b> <em>FALSE|TRUE</em> <br  />
 Description: Just run a color filter.</li>
<li><b>name:</b> <code>DETECT_GATE_N_SAMPLES</code> <b>value:</b> <em>10000</em> <br  />
 Description: The number of samples taken in an image for snake gate detection. This number is proportional to the computatinoal effort (more = slower) and the performance (more = better).</li>
<li><b>name:</b> <code>DETECT_GATE_MIN_PIX_SIZE</code> <b>value:</b> <em>30</em> <br  />
 Description: The minimal size the sides of an initial (square) detection should have for further processing.</li>
<li><b>name:</b> <code>DETECT_GATE_MIN_GATE_QUALITY</code> <b>value:</b> <em>0.15</em> <br  />
 Description: Gate quality is checked by verifying the proportion of colored pixels on the gate outline. This is the minimal proportion of colored pixels in order to accept a gate candidate.</li>
<li><b>name:</b> <code>DETECT_GATE_MIN_N_SIDES</code> <b>value:</b> <em>3</em> <br  />
 Description: How many sides of the gate should have the minimal line quality (min = 0, max = 4).</li>
<li><b>name:</b> <code>DETECT_GATE_GATE_THICKNESS</code> <b>value:</b> <em>0.0</em> <br  />
 Description: Snaking goes up and down, and then left and right from the extreme points. If the gate is thick, it is better to start a little bit before the end point. This value is how thick the gate border is as a proportion of the total size.</li>
<li><b>name:</b> <code>DETECT_GATE_Y_MIN</code> <b>value:</b> <em>20</em> <br  />
 Description: Minimal Y of the color filter.</li>
<li><b>name:</b> <code>DETECT_GATE_Y_MAX</code> <b>value:</b> <em>228</em> <br  />
 Description: Maximal Y of the color filter.</li>
<li><b>name:</b> <code>DETECT_GATE_U_MIN</code> <b>value:</b> <em>42</em> <br  />
 Description: Minimal U of the color filter.</li>
<li><b>name:</b> <code>DETECT_GATE_U_MAX</code> <b>value:</b> <em>121</em> <br  />
 Description: Maximal U of the color filter.</li>
<li><b>name:</b> <code>DETECT_GATE_V_MIN</code> <b>value:</b> <em>134</em> <br  />
 Description: Minimal V of the color filter.</li>
<li><b>name:</b> <code>DETECT_GATE_V_MAX</code> <b>value:</b> <em>230</em> <br  />
 Description: Maximal V of the color filter.</li>
<li><b>name:</b> <code>DETECT_GATE_EXCLUDE_PIXELS_TOP</code> <b>value:</b> <em>0</em> <br  />
 Description: Band on top of the image in which we do not take snake gate samples.</li>
<li><b>name:</b> <code>DETECT_GATE_EXCLUDE_PIXELS_BOTTOM</code> <b>value:</b> <em>0</em> <br  />
 Description: Band at the bottom of the image in which we do not take snake gate samples.</li>
<li><b>name:</b> <code>DETECT_GATE_SIMPLIFIED_PNP</code> <b>value:</b> <em>0</em> <br  />
 Description: When set to 0, the full PnP will fit all corners. When set to 1, a simple camera model will be used.</li>
<li><b>name:</b> <code>CAMERA_ROTATED_90DEG_RIGHT</code> <b>value:</b> <em>FALSE</em> <br  />
 Description: If the camera does not have its longest side as horizontal, then the rotated define should be enabled.</li>
</ul>
<h1><a class="anchor" id="functions__cv_detect_gate"></a>
Module functions</h1>
<h2><a class="anchor" id="init_functions"></a>
Init Functions</h2>
<p>These initialization functions are called once on startup.</p>
<ul>
<li><a class="el" href="detect__gate_8c.html#afad85937ed43b1d2963bec59f0031ec1">detect_gate_init()</a></li>
</ul>
<h2><a class="anchor" id="event_functions"></a>
Event Functions</h2>
<p>These event functions are called in each cycle of the module event loop.</p>
<ul>
<li><a class="el" href="detect__gate_8c.html#a31c10819cde7e0649fb2a208d89d8c68">detect_gate_event()</a></li>
</ul>
<h1><a class="anchor" id="files"></a>
Files</h1>
<h2><a class="anchor" id="headers"></a>
Header Files</h2>
<p>The following headers are automatically included in modules.h</p>
<ul>
<li><a class="el" href="detect__gate_8h.html">detect_gate.h</a></li>
</ul>
<h2><a class="anchor" id="sources"></a>
Source Files</h2>
<ul>
<li><a class="el" href="detect__gate_8c.html">modules/computer_vision/detect_gate.c</a></li>
<li><a class="el" href="undistortion_8c.html">modules/computer_vision/lib/vision/undistortion.c</a></li>
<li><a class="el" href="image_8c.html">modules/computer_vision/lib/vision/image.c</a></li>
<li><a class="el" href="PnP__AHRS_8c.html">modules/computer_vision/lib/vision/PnP_AHRS.c</a></li>
<li><a class="el" href="snake__gate__detection_8c.html">modules/computer_vision/snake_gate_detection.c</a></li>
</ul>
<h2><a class="anchor" id="module_xml__cv_detect_gate"></a>
Raw cv_detect_gate.xml file:</h2>
<div class="fragment"><div class="line">&lt;!<span class="keyword">DOCTYPE</span> <span class="keyword">module</span> <span class="keyword">SYSTEM</span> <span class="stringliteral">&quot;module.dtd&quot;</span>&gt;</div>
<div class="line"> </div>
<div class="line">&lt;<span class="keywordtype">module</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;cv_detect_gate&quot;</span> <span class="keyword">dir</span>=<span class="stringliteral">&quot;computer_vision&quot;</span>&gt;</div>
<div class="line">  &lt;<span class="keywordtype">doc</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">description</span>&gt;</div>
<div class="line">  <span class="keyword">Detects</span> <span class="keyword">gates</span> <span class="keyword">as</span> <span class="keyword">used</span> <span class="keyword">in</span> <span class="keyword">the</span> <span class="keyword">IROS</span> <span class="keyword">drone</span> <span class="keyword">races</span>, <span class="keyword">i.e.</span>, <span class="keyword">square</span> <span class="keyword">colored</span> <span class="keyword">gates.</span> <span class="keyword">It</span> <span class="keyword">does</span> <span class="keyword">so</span> <span class="keyword">with</span> <span class="keyword">snake</span> <span class="keyword">gate</span> <span class="keyword">detection</span>, <span class="keyword">a</span> <span class="keyword">computationally</span> <span class="keyword">efficient</span> <span class="keyword">method</span> <span class="keyword">that</span> <span class="keyword">works</span> </div>
<div class="line">  <span class="keyword">onboard</span> <span class="keyword">of</span> <span class="keyword">the</span> <span class="keyword">computationally</span> <span class="keyword">constrained</span> <span class="keyword">Parrot</span> <span class="keyword">Bebop</span> 1/2 <span class="keyword">drones.</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">An</span> <span class="keyword">initial</span> <span class="keyword">version</span> <span class="keyword">of</span> <span class="keyword">this</span> <span class="keyword">algorithm</span> <span class="keyword">ran</span> <span class="keyword">in</span> <span class="keyword">the</span> <span class="keyword">drone</span> <span class="keyword">race</span> 2016. <span class="keyword">The</span> <span class="keyword">algorithm</span> <span class="keyword">was</span> <span class="keyword">first</span> <span class="keyword">described</span> <span class="keyword">in:</span></div>
<div class="line">  </div>
<div class="line">  <span class="keyword">First</span> <span class="keyword">autonomous</span> <span class="keyword">multi-room</span> <span class="keyword">exploration</span> <span class="keyword">with</span> <span class="keyword">an</span> <span class="keyword">insect-inspired</span> <span class="keyword">flapping</span> <span class="keyword">wing</span> <span class="keyword">vehicle</span>, <span class="keyword">May</span> 2018, </div>
<div class="line">  <span class="keyword">IEEE</span> <span class="keyword">International</span> <span class="keyword">Conference</span> <span class="keyword">on</span> <span class="keyword">Robotics</span> <span class="keyword">and</span> <span class="keyword">Automation</span> (<span class="keyword">ICRA</span> 2018), <span class="keyword">Brisbane</span>, <span class="keyword">Australia</span></div>
<div class="line">  <span class="keyword">by</span> <span class="keyword">Kirk</span> <span class="keyword">Scheper</span>, <span class="keyword">Matej</span> <span class="keyword">Karasek</span>, <span class="keyword">Christophe</span> <span class="keyword">De</span> <span class="keyword">Wagter</span>, <span class="keyword">Bart</span> <span class="keyword">Remes</span>, <span class="keyword">and</span> <span class="keyword">Guido</span> <span class="keyword">de</span> <span class="keyword">Croon</span></div>
<div class="line">  <span class="keyword">https:</span>//<span class="keyword">www.researchgate.net</span>/<span class="keyword">publication</span>/327228053<span class="keyword">_First_autonomous_multi-room_exploration_with_an_insect-inspired_flapping_wing_vehicle</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">For</span> <span class="keyword">the</span> <span class="keyword">drone</span> <span class="keyword">race</span>, <span class="keyword">the</span> <span class="keyword">algorithm</span> <span class="keyword">and</span> <span class="keyword">performance</span> <span class="keyword">are</span> <span class="keyword">described</span> <span class="keyword">in</span> <span class="keyword">more</span> <span class="keyword">detail</span> <span class="keyword">in:</span></div>
<div class="line">  <span class="keyword">Autonomous</span> <span class="keyword">drone</span> <span class="keyword">race:</span> <span class="keyword">A</span> <span class="keyword">novel</span> <span class="keyword">vision-based</span> <span class="keyword">navigation</span> <span class="keyword">and</span> <span class="keyword">control</span> <span class="keyword">strategy</span>,</div>
<div class="line">  <span class="keyword">S.Li</span>, <span class="keyword">M.M.O.I.</span> <span class="keyword">Ozo</span>, <span class="keyword">C.</span> <span class="keyword">De</span> <span class="keyword">Wagter</span>, <span class="keyword">G.C.H.E.</span> <span class="keyword">de</span> <span class="keyword">Croon.</span></div>
<div class="line">  <span class="keyword">Submitted.</span></div>
<div class="line"> </div>
<div class="line">    &lt;/<span class="keywordtype">description</span>&gt;</div>
<div class="line">    <span class="comment">&lt;!-- &lt;define name=&quot;UNDISTORT_MIN_X_NORMALIZED&quot; value=&quot;-2.0&quot; description=&quot;Minimal normalized x-coordinate to be used for the undistortion&quot;/&gt; --&gt;</span> </div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DETECT_GATE_FPS&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;The (maximum) frequency to run the calculations at. If zero, it will max out at the camera frame rate.&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DETECT_GATE_CAMERA&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;bottom_camera|front_camera&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;The V4L2 camera device that is used for the calculations.&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DETECT_GATE_JUST_FILTER&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;FALSE|TRUE&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;Just run a color filter.&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DETECT_GATE_N_SAMPLES&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;10000&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;The number of samples taken in an image for snake gate detection. This number is proportional to the computatinoal effort (more = slower) and the performance (more = better).&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DETECT_GATE_MIN_PIX_SIZE&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;30&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;The minimal size the sides of an initial (square) detection should have for further processing.&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DETECT_GATE_MIN_GATE_QUALITY&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;0.15&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;Gate quality is checked by verifying the proportion of colored pixels on the gate outline. This is the minimal proportion of colored pixels in order to accept a gate candidate.&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DETECT_GATE_MIN_N_SIDES&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;3&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;How many sides of the gate should have the minimal line quality (min = 0, max = 4).&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DETECT_GATE_GATE_THICKNESS&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;0.0&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;Snaking goes up and down, and then left and right from the extreme points. If the gate is thick, it is better to start a little bit before the end point. This value is how thick the gate border is as a proportion of the total size.&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DETECT_GATE_Y_MIN&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;20&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;Minimal Y of the color filter.&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DETECT_GATE_Y_MAX&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;228&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;Maximal Y of the color filter.&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DETECT_GATE_U_MIN&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;42&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;Minimal U of the color filter.&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DETECT_GATE_U_MAX&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;121&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;Maximal U of the color filter.&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DETECT_GATE_V_MIN&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;134&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;Minimal V of the color filter.&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DETECT_GATE_V_MAX&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;230&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;Maximal V of the color filter.&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DETECT_GATE_EXCLUDE_PIXELS_TOP&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;Band on top of the image in which we do not take snake gate samples.&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DETECT_GATE_EXCLUDE_PIXELS_BOTTOM&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;Band at the bottom of the image in which we do not take snake gate samples.&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;DETECT_GATE_SIMPLIFIED_PNP&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;When set to 0, the full PnP will fit all corners. When set to 1, a simple camera model will be used.&quot;</span> /&gt;</div>
<div class="line">    &lt;<span class="keywordtype">define</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;CAMERA_ROTATED_90DEG_RIGHT&quot;</span> <span class="keyword">value</span>=<span class="stringliteral">&quot;FALSE&quot;</span> <span class="keyword">description</span>=<span class="stringliteral">&quot;If the camera does not have its longest side as horizontal, then the rotated define should be enabled.&quot;</span> /&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">doc</span>&gt;</div>
<div class="line"> </div>
<div class="line">  &lt;<span class="keywordtype">settings</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">dl_settings</span>&gt;</div>
<div class="line">      &lt;<span class="keywordtype">dl_settings</span> <span class="keyword">NAME</span>=<span class="stringliteral">&quot;Detect gate&quot;</span>&gt;</div>
<div class="line">   &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;just_filtering&quot;</span> <span class="keyword">min</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">values</span>=<span class="stringliteral">&quot;FALSE|TRUE&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;just_filter&quot;</span> <span class="keyword">param</span>=<span class="stringliteral">&quot;DETECT_GATE_JUST_FILTER&quot;</span>/&gt;</div>
<div class="line">   &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;n_samples&quot;</span>  <span class="keyword">min</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;10&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;10000&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;n_samples&quot;</span> <span class="keyword">param</span>=<span class="stringliteral">&quot;DETECT_GATE_N_SAMPLES&quot;</span>/&gt; </div>
<div class="line">   &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;min_px_size&quot;</span>  <span class="keyword">min</span>=<span class="stringliteral">&quot;10&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;5&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;500&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;min_px&quot;</span> <span class="keyword">param</span>=<span class="stringliteral">&quot;DETECT_GATE_MIN_PIX_SIZE&quot;</span>/&gt; </div>
<div class="line">   &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;min_gate_quality&quot;</span>  <span class="keyword">min</span>=<span class="stringliteral">&quot;0.0&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;0.01&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;1.0&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;min_qual&quot;</span> <span class="keyword">param</span>=<span class="stringliteral">&quot;DETECT_GATE_MIN_GATE_QUALITY&quot;</span>/&gt;</div>
<div class="line">   &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;min_n_sides&quot;</span>  <span class="keyword">min</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;4&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;min_sides&quot;</span> <span class="keyword">param</span>=<span class="stringliteral">&quot;DETECT_GATE_MIN_N_SIDES&quot;</span>/&gt; </div>
<div class="line">   &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;gate_thickness&quot;</span>  <span class="keyword">min</span>=<span class="stringliteral">&quot;0.0&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;0.01&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;0.2&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;thickness&quot;</span> <span class="keyword">param</span>=<span class="stringliteral">&quot;DETECT_GATE_GATE_THICKNESS&quot;</span>/&gt; </div>
<div class="line">   &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;color_Ym&quot;</span>  <span class="keyword">min</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;255&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;Y_min&quot;</span> <span class="keyword">param</span>=<span class="stringliteral">&quot;DETECT_GATE_Y_MIN&quot;</span>/&gt;</div>
<div class="line">   &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;color_YM&quot;</span>  <span class="keyword">min</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;255&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;Y_max&quot;</span> <span class="keyword">param</span>=<span class="stringliteral">&quot;DETECT_GATE_Y_MAX&quot;</span>/&gt;</div>
<div class="line">   &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;color_Um&quot;</span>  <span class="keyword">min</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;255&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;U_min&quot;</span> <span class="keyword">param</span>=<span class="stringliteral">&quot;DETECT_GATE_U_MIN&quot;</span>/&gt;</div>
<div class="line">   &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;color_UM&quot;</span>  <span class="keyword">min</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;255&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;U_max&quot;</span> <span class="keyword">param</span>=<span class="stringliteral">&quot;DETECT_GATE_U_MAX&quot;</span>/&gt;</div>
<div class="line">   &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;color_Vm&quot;</span>  <span class="keyword">min</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;255&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;V_min&quot;</span> <span class="keyword">param</span>=<span class="stringliteral">&quot;DETECT_GATE_V_MIN&quot;</span>/&gt;</div>
<div class="line">   &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;color_VM&quot;</span>  <span class="keyword">min</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;255&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;V_max&quot;</span> <span class="keyword">param</span>=<span class="stringliteral">&quot;DETECT_GATE_V_MAX&quot;</span>/&gt;</div>
<div class="line">   &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;exclude_top&quot;</span>  <span class="keyword">min</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;320&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;exclude_top&quot;</span> <span class="keyword">param</span>=<span class="stringliteral">&quot;DETECT_GATE_EXCLUDE_PIXELS_TOP&quot;</span>/&gt;</div>
<div class="line">   &lt;<span class="keywordtype">dl_setting</span> <span class="keyword">var</span>=<span class="stringliteral">&quot;exclude_bottom&quot;</span>  <span class="keyword">min</span>=<span class="stringliteral">&quot;0&quot;</span> <span class="keyword">step</span>=<span class="stringliteral">&quot;1&quot;</span> <span class="keyword">max</span>=<span class="stringliteral">&quot;320&quot;</span> <span class="keyword">shortname</span>=<span class="stringliteral">&quot;exclude_bottom&quot;</span> <span class="keyword">param</span>=<span class="stringliteral">&quot;DETECT_GATE_EXCCLUDE_PIXELS_BOTTOM&quot;</span>/&gt;</div>
<div class="line">      &lt;/<span class="keywordtype">dl_settings</span>&gt;</div>
<div class="line">    &lt;/<span class="keywordtype">dl_settings</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">settings</span>&gt;</div>
<div class="line"> </div>
<div class="line">  &lt;<span class="keywordtype">dep</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">depends</span>&gt;<span class="keyword">video_thread</span>&lt;/<span class="keywordtype">depends</span>&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">dep</span>&gt;</div>
<div class="line"> </div>
<div class="line">  &lt;<span class="keywordtype">header</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">file</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;detect_gate.h&quot;</span>/&gt;</div>
<div class="line">  &lt;/<span class="keywordtype">header</span>&gt;</div>
<div class="line"> </div>
<div class="line">  &lt;<span class="keywordtype">init</span> <span class="keyword">fun</span>=<span class="stringliteral">&quot;detect_gate_init()&quot;</span>/&gt;</div>
<div class="line">  &lt;<span class="keywordtype">event</span> <span class="keyword">fun</span>=<span class="stringliteral">&quot;detect_gate_event()&quot;</span>/&gt;</div>
<div class="line">  &lt;<span class="keywordtype">makefile</span> <span class="keyword">target</span>=<span class="stringliteral">&quot;ap|nps&quot;</span>&gt;</div>
<div class="line">    &lt;<span class="keywordtype">file</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;detect_gate.c&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">file</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;undistortion.c&quot;</span> <span class="keyword">dir</span>=<span class="stringliteral">&quot;modules/computer_vision/lib/vision&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">file</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;image.c&quot;</span> <span class="keyword">dir</span>=<span class="stringliteral">&quot;modules/computer_vision/lib/vision&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">file</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;PnP_AHRS.c&quot;</span> <span class="keyword">dir</span>=<span class="stringliteral">&quot;modules/computer_vision/lib/vision&quot;</span>/&gt;</div>
<div class="line">    &lt;<span class="keywordtype">file</span> <span class="keyword">name</span>=<span class="stringliteral">&quot;snake_gate_detection.c&quot;</span> <span class="keyword">dir</span>=<span class="stringliteral">&quot;modules/computer_vision&quot;</span>/&gt;    </div>
<div class="line">  &lt;/<span class="keywordtype">makefile</span>&gt;</div>
<div class="line">&lt;/<span class="keywordtype">module</span>&gt;</div>
<div class="line"> </div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="onboard_modules.html">Onboard Modules</a></li>
    <li class="footer">Generated on Tue Jul 29 2025 16:15:58 for Paparazzi UAS by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
